# Elasticsearch 技术大纲

> 整理Elasticsearch资料，知识回顾与学习
>
> 资料来源
>
> [https://es.xiaoleilu.com](https://es.xiaoleilu.com/)

## 大纲目录

### 1. 基本特性

> 对文档进行了一定的整理，用于帮助记忆与查询

1. API

   1. Java API 

      1. 节点客户端
         - 以无数据节点身份加入集群
      2. 传输客户端
         - 自己不加入集群，发送请求到集群

      

      均通过 Port 9300 与集群交互，使用Elasticsearch传输协议

      

   2. RESTful API
   
2. 分布式集群

   1. 名词术语
      - 纵向扩展 vertical scale or scaling up
      - 横向扩展 horizontal scale or scaling out
      - 集群 cluster
      - 节点 node
        - 主节点 master
      - 分片 shards
        - 主要分片 primary shard
        - 复制分片 replica shard
      - 索引 index
   2. 空集群
      1. 一个**节点**就是一个ES实例，一个**集群**由一个或多个节点组成
         1. 配置文件中`cluster.name`相同并且可互相发现便可以加入同一个集群
         2. 集群中的一个节点会被选举为**主节点**
   3. 集群健康
      1. 三种状态
         1. `green` 所有主要分片和复制分片都可使用
         2. `yellow` 所有主要分片可用，但不是所有复制分片都可用
         3. `red` 不是所有主要分片都可用
   4. 添加索引
      1. **索引**是一个用来指向一个或多个**分片**的**“逻辑命名空间”**
      2. 分片是一个Lucene实例，并且本身就是一个完整的搜索引擎
      3. 索引中的每个文档属于一个单独的主分片，因此主分片的数量决定了索引最多能存储多少数据。
      4. 复制分片只是主分片的一个副本，可以防止硬件故障导致的数据丢失，同事可以提供读请求，比如搜索或者从别的shard取回文档。
      5. 索引创建完成时主分片的数量就固定了，但是复制分片的数量可以随时调整。
   5. 增加故障转移
      1. 启动另一个节点
         1. 节点的`cluster.name`相同，可以互相发现
         2. 分配复制分片，备份数据，防止单点故障
   6. 横向扩展
      1. 启动新节点后会自动重新分配分片以平衡负载
