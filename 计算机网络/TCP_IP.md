# 0x01 TCP/IP 网络通信原理

## TCP/IP 参考模型

### 主机-网络层（Host to Network Layer）

TCP/IP 参考协议的最底层，也称为**网络接口层**

主要负责接收从互联网层交来的 IP 数据包并将其通过底层物理网络发送出去，或者从低层物理网络上接收物理帧并从中抽出 IP 数据报交给互联网络层

类型：

1. 设备驱动程序

   如局域网的网络接口

2. 含自身数据链路协议的复杂子系统

   在 TCP/IP 参考模型中未定义数据链路层，这主要是因为在 TCP/IP 最初的设计中已经可以使其使用各种典型的数据链路层协议。

### 互联网层（Internet Layer）

也称为网际互连层或 IP 层，主要负责将源主机的**报文分组**发送到目的主机

由于 TCP/IP 参考模型中网络层协议是 IP 协议，因此互联网络层也称为 IP 层。其中，IP 协议是一种不可靠，无连接的数据报传送服务的协议，它提供的是"Best Effect"的服务。  
IP 协议的协议数据单元是 IP 分组，由于在 IP 层提供数据报服务，因此，也常将 IP 分组称为**IP 数据报**。

### 传输层（Transport Layer）

主要负责在互联网中源主机与目的主机的对等进程实体之间提供可靠的端到端的数据传输。

协议：

1. **TCP 协议** 是一种可靠的面向连接的协议，它允许将一台主机的字节流无差错的传送到目的主机。TCP 协议将应用层的字节流分成许多个字节段，然后将一个个的字节段传输到互联网络层，最后发送到目的主机。当互联网络层将接收到的字节传送给传输层时，传输层再将多个字节段还原成原始的字节流，并传输到应用层。TCP 协议同时要完成**流量控制**功能，协调收发双方的发送与接收速度，以达到正确传输的目的。
2. **UDP 协议** 是一种不可靠的无连接协议，它主要用于不要求分组顺序到达的传输服务之中，在基于 UDP 协议的传输服务中，分组的传输顺序检查与排序由应用层完成。

   - 主要面向请求-应答式的交易型应用，一次交易往往只有一个来回的报文交换。
   - 也常用于那些对可靠性要求不高，但是要求网络的延迟较小的场合，如语音和视频数据的传送等。

### 应用层（Application Layer）

应用层包括了所有的高层协议，目前 TCP/IP 参考模型中主要包括一下几种：

1. 网络终端协议 （Telnet）；
2. 文件传输协议 （File Transfer Protocol, FTP）；
3. 简单邮件传输协议 （Simple Mail Transfer Protocol, SMTP）；
4. 域名系统 （Domain Name System, DNS）；
5. 简单网络管理协议 （Simple Network Management Protocol, SNMP）；
6. 超文本传输协议 （Hyper Text Transfer Protocol, HTTP）；

## TCP/IP 参考模型的通信原理

| 主机 A     |     |                |     | 主机 B     |
| ---------- | --- | -------------- | --- | ---------- |
| 应用层     | <-- | 各层对等协议   | --> | 应用层     |
| 传输层     | <-- | 各层对等协议   | --> | 传输层     |
| /          | --- | ---路由器---   | --- | /          |
| 网际互连层 | <-> | \|网际互连层\| | <-> | 网际互连层 |
| 网络接口层 | <-> | \|网络接口层\| | <-> | 网络接口层 |

> 数据通信不是计算机网络的最终目的，计算机网络的本质活动是实现分布在不同地理位置的主机之间的进程通信，以实现各种网络功能。  
> **传输层**的主要目的是为了实现上述这种分布式进程之间的通信功能。

网间分布式进程要解决的是**不同主机之间的相互通信问题**（同机通信问题只是其中的一个特例）。为此，传输层需要解决在网络环境中分布式进程通信所需解决的以下两个方面的问题：

1. **进程命名与寻址**
2. **多重协议的识别**
