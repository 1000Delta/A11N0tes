# Paxos 算法

Paxos是分布式系统中的核心算法，现代分布式算法基本都是其变体。

## 定义

### 提案者 proposer

### 接收者 receiver

### 票 ticket

### 提案 propose

## 算法

### 初始化

#### 提案者

- 等待执行的命令`c`
- 当前尝试的票号`t`

#### 接收者

- 当前已发布的最大票号 `TMax`
- 当前存储的命令`C`
- 用于存储命令`C`的票 `TStore`

### 算法步骤

1. 提案者：向所有接收者请求一张指定编号的**票** `t`
2. 接收者：如果请求的票号大于已有的最大票号`t > TMax`，将最大票号替换成亲请求的票号`TMax = t`，并将之前存储的最大票号和票号对应的命令`C`返回给提案者`ok(TStore, C)`
3. 提案者：如果过半数的接收者返回了信息，则检查接收者返回的票号`TStore`，若存在最大有效票号`TStore > 0`，则将自己需要执行的命令替换成票号对应的命令`c = C`并向服务器发送一个**提案**，提案内容为请求的票号与最终确定要执行的命令
4. 接收者：如果票号与当前最大票号相等，则将票号和命令存储`C = c, TStore = t`，并向提案者回复success
5. 如果过半数的接收者返回了success，则向所有服务器发送执行命令`execute(c)`