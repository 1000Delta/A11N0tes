# 龙格库塔法

## 简介

龙格库塔法（Runge-Kutta）是一种用于计算非线性常微分方程的一类显式或隐式迭代法。由数学家 卡尔.龙格 和 马丁.威尔海姆.库塔 于1900年左右发明。

在此处只介绍最常用的四阶龙格库塔公式，经常被称作“RK4”，或者就是“龙格-库塔法”。

## 公式

 初值问题表述如下：
$$
\begin{aligned}
y' = f(t, y),y(t_0) = y_0 \\
\end{aligned}
$$

则该问题的RK4由如下方程给出：
$$
y_{n+1} = y_{n} + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)
$$
其中
$$
\begin{aligned}
k_1 &= f(t_n, y_n) \\
k_2 &= f(t_n+\frac{h}{2}, y_n+\frac{h}{2}k_1) \\
k_3 &= f(t_n+\frac{h}{2}, y_n+\frac{h}{2}k_2) \\
k_4 &= f(t_n+h, yn+hk_3)
\end{aligned}
$$

## 解释

下一个值（y_{n+1}）由现在的值（y_n）加上时间间隔（h）和一个估算的斜率的乘积决定。该斜率是以下斜率的加权平均：

- k_1是时间段开始时的斜率
- k_2是时间段中点的斜率，通过欧拉法采用斜率k_1来决定y在点t_n+h/2时的值
- k_3也是中点的斜率，但是采用k_2决定y值
- k_4是时间段终点的斜率，其y值用k_3决定

当四个斜率取加权平均时，中点的斜率有更大的权值：
$$
\text{slope}=\frac{k_1+2k_2+2k_3+k_4}{6}
$$
