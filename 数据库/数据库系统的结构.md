# 数据库系统的结构

## 概念

- 从数据库应用开发人员角度来看

  数据库系统采用三级模式结构，是数据库系统内部的系统结构

- 从数据库最终用户角度看
  - 单用户结构
  - 主从式结构
  - 分布式结构
  - 客户-服务器
  - 浏览器-应用服务器 / 数据库服务器

---

- 模式 （Schema）
  - 是对数据库逻辑结构和特征的描述
  - 是型的描述，不涉及具体值
  - 模式是相对稳定的
- 实例 （Instance）
  - 数据库某一时刻的状态 —— 模式的一个具体值
  - 同一个模式可以有很多实例
  - 实例随数据库中的数据而变化



## 三级模式结构

数据库 -> **内模式** -> **模式** -> **外模式** -> 应用

- **模式**（也称逻辑模式）

  - 数据库中全体数据的逻辑结构和特征的描述
  - 所有用户的公共数据视图

- 模式是数据库模式系统结构的中心

  - 与数据的物理存储细节和硬件环境无关
  - 与具体的应用程序、开发工具和高级程序设计语言无关

- 定义模式

  - DDL定义数据的逻辑结构，以某种数据模型为基础

    数据记录由哪些数据项构成，数据项的名字、类型、取值范围等

  - 定义数据之间的关系

  - 定义与数据有关的安全性、完整性要求

- **外模式** （也称子模式或用户模式）

  数据库用户使用的局部数据的逻辑结构和特征的描述

- 外模式与模式的关系

  - 通常是模式的子集，一个模式可以有多个外模式

    反映了不同的用户的应用需求、看待数据的方式、对数据保密的要求

  - 对模式中某一数据，在不同的外模式中结构、类型等都可以不同

- 与应用的关系

  - 可以为多个应用系统所使用， 一个应用程序只能使用一个外模式

- 用途

  - 每个用户只能看见和访问所对应的外模式中的数据，简化用户视图
  - 保证数据库安全性的一个有力措施

- **内模式** （存储模式）
  - 是数据物理结构和存储方式的描述
  - 是数据在数据库内部的表示方式
    - 记录的存储方式 （顺序、堆、hash等）
    - 索引的组织方式 （B+树、Bitmap，Hash）
    - 数据是否压缩存储
    - 数据是否加密
    - 数据存储记录结构的规定 —— 如定长/变长，记录是否可以跨页存放等
- 一个数据库只有一个内模式



## 数据库的二级映像功能与数据独立性

- 三级模式是对数据的三个抽象级别
- 数据库管理系统内部提供二级映像
  - 外模式 / 模式映像
  - 内模式 / 模式映像
- 三个抽象层次间的联系和转换

### 外模式 / 模式映像

- 对每一个外模式都有一个外模式/模式映像定义外模式与模式之间的对应关系

  映像通常包含在各外模式的描述中

- 保证数据的逻辑独立性

  - 当**模式改变**时，数据库管理员**对外模式 / 模式映像作相应改变**， 使**外模式不变** （即外模式作为内外交互的接口，对于底层（内模式）的改变，我们需要对接口内部实现（外模式/模式映像）进行修改，来保证接口外部特性（外模式）不变）
  - 应用程序时依据数据的外模式编写的，应用程序不必修改，保证了数据与程序的逻辑独立性，简称数据的逻辑独立性

