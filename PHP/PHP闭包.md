# PHP闭包

又叫匿名函数 (Anonymous functions)  , 允许临时创建一个没有指定名称的函数.

目前在PHP中是通过`Closure`类来实现的.

闭包可以用作回调函数, 在支持回调的函数中执行一些功能;

闭包也可以作为变量的值来使用, 使用方式类似于JavaScript中的函数字面量, 但是表达式在PHP中会被自动转化成`Closure`内置类;

```php
<?php
    $foo = function() {
    
    // todo
};
```

闭包可以从父作用域中继承变量, 但是所有要继承的变量都应该通过`use`从父作用域中引入, 而不能直接使用, 否则会提示使用了未定义变量.

```php
<?php
$val1 = 1;
$val2 = 2;
$foo1 = function () {
    // undefined variable
    echo $val1;
};
$foo2 = function () use ($val1) {
    // 正确用法
    echo $val1;
};
$foo3 = function () use ($val1, $val2) {
    
    echo $val1, $val2;
}
```

使用use将父作用域变量传入闭包后, 相当于在闭包内创建了变量的副本, 闭包内外的同名变量实际上是不同的变量, 对其的修改不会互相影响. 可以通过在`use`内传递引用的方式来将外部的变量引用到内部, 此时在闭包内外对引用的操作都会互相影响.

> **注意**: 外部变量分为全局变量和父作用域变量, 全局变量存在一个**全局的范围**, 无需使用`use`引入, 父作用域变量需要引入, 父作用域变量一般是定义该闭包的函数, 而不一定是调用闭包的函数.